# Day 00 - Бассейн SQL

## _Реляционная модель данных и SQL_

Загрузите [скрипт](../materials/model.sql) с моделью базы данных здесь и примените его к своей базе данных (вы можете использовать командную строку с psql или просто запустить его через любую IDE, например DataGrip от JetBrains или pgAdmin от сообщества PostgreSQL).

![schema](../materials/schema.png)

1. **pizzeria** (Таблица-словарь с доступными пиццериями)
- id - первичный ключ (primary key)
- name - название пиццерии
- rating - средний рейтинг пиццерии (от 0 до 5 баллов)
2. **person** (Таблица-словарь с людьми, которые любят пиццу)
- id - первичный ключ
- name - имя человека
- age - возраст человека
- gender - пол человека
- address - адрес человека
3. **menu** (Таблица-словарь с доступным меню и ценой на конкретную пиццу)
- id - первичный ключ
- pizzeria_id - внешний ключ к пиццерии (foreign key)
- pizza_name - название пиццы в пиццерии
- price - цена конкретной пиццы
4. **person_visits** (Операционная таблица с информацией о посещениях пиццерии)
- id - первичный ключ
- person_id - внешний ключ к человеку
- pizzeria_id - внешний ключ к пиццерии
- visit_date - дата (например 2022-01-01) посещения человека
5. **person_order** (операционная таблица с информацией о заказах людей)
- id - первичный ключ
- person_id - внешний ключ к человеку
- menu_id - внешний ключ к меню
- order_date - дата (например 2022-01-01) заказа человека

Посещение лиц и заказ лиц являются разными сущностями и не содержат никакой корреляции между данными. Например, клиент может находиться в одном ресторане (просто просматривая меню) и в это время сделать заказ в другом по телефону или через мобильное приложение. Или другой случай, просто быть дома и снова сделать звонок с заказом без всяких визитов.

## Упражнение 00. Первые шаги в мир SQL

Пожалуйста, сделайте оператор select, который возвращает все имена и возраст людей из города «Казань».

## Упражнение 01. Первые шаги в мир SQL

Пожалуйста, сделайте оператор select, который возвращает имена и возраст для всех женщин из города «Казань». Да, и, пожалуйста, отсортируйте результат по имени.

## Упражнение 02. Первые шаги в мир SQL

Пожалуйста, сделайте 2 оператора выбора с разными синтаксисом, которые возвращают список пиццерий (название пиццерии и рейтинг) с рейтингом от 3,5 до 5 баллов (включая предельные баллы) и упорядоченные по рейтингу пиццерии.
- 1-й оператор select должен содержать знаки сравнения (<=, >=)
- второй оператор select должен содержать BETWEENключевое слово

## Упражнение 03. Первые шаги в мир SQL

Пожалуйста, сделайте оператор select, который возвращает идентификаторы человека (без дублирования), который посетил пиццерию в период с 6 января 2022 года по 9 января 2022 года (включая все дни) или посетил пиццерию с идентификатором 2. Также включите пункт заказа по идентификатору человека в нисходящий режим.

## Упражнение 04. Первые шаги в мир SQL

Пожалуйста, сделайте оператор select, который возвращает одно вычисляемое поле с именем «person_information» в одной строке, как описано в следующем примере:

`Anna (age:16,gender:'female',address:'Moscow')`

Наконец, добавьте пункт упорядочения по вычисляемому столбцу в возрастающем режиме. Обратите внимание на кавычки в формуле!

## Упражнение 05. Первые шаги в мир SQL

Пожалуйста, сделайте оператор select, который возвращает имена людей (на основе внутреннего запроса в SELECTпредложении), которые сделали заказы на меню с идентификаторами 13 , 14 и 18, а дата заказов должна быть равна 7 января 2022 года. Пожалуйста, обратите внимание на «Отклоненный раздел» до твоя работа.

Пожалуйста, взгляните на шаблон внутреннего запроса.

    SELECT
	    (SELECT ... ) AS NAME  -- this is an internal query in a main SELECT clause
    FROM ...
    WHERE ...

## Упражнение 06. Первые шаги в мир SQL

Пожалуйста, используйте конструкцию SQL из упражнения 05 и добавьте новый вычисляемый столбец (используйте имя столбца 'check_name') с оператором проверки (псевдокод для этой проверки представлен ниже) в SELECT предложении.

    if (person_name == 'Denis') then return true
        else return false

## Упражнение 07. Первые шаги в мир SQL

Применим интервалы данных для `person` таблицы.
Пожалуйста, сделайте оператор SQL, который возвращает идентификаторы людей, имена людей и интервал возрастов людей (задайте имя нового вычисляемого столбца как «interval_info») на основе приведенного ниже псевдокода.

    if (age >= 10 and age <= 20) then return 'interval #1'
    else if (age > 20 and age < 24) then return 'interval #2'
    else return 'interval #3'

и да... пожалуйста, отсортируйте результат по столбцу "interval_info" в порядке возрастания.

## Упражнение 08. Первые шаги в мир SQL

Пожалуйста, сделайте оператор SQL, который возвращает все столбцы из `person_order` таблицы со строками, идентификатор которых является четным числом. Результат должен быть упорядочен по возвращаемому идентификатору.

## Упражнение 09. Первые шаги в мир SQL

Пожалуйста, сделайте оператор select, который возвращает имена людей и названия пиццерий на основе `person_visit` таблицы с датой посещения в период с 07 января по 09 января 2022 года (включая все дни) (на основе внутреннего запроса в FROMпункте) .

Пожалуйста, взгляните на шаблон окончательного запроса.

    SELECT (...) AS person_name ,  -- this is an internal query in a main SELECT clause
            (...) AS pizzeria_name  -- this is an internal query in a main SELECT clause
    FROM (SELECT … FROM person_visits WHERE …) AS pv -- this is an internal query in a main FROM clause
    ORDER BY ...

Пожалуйста, добавьте пункт заказа по имени человека по возрастанию и по названию пиццерии по убыванию